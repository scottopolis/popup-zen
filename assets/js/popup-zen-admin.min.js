!function(e,n,t,o){var i={};i.init=function(){i.listeners(),i.disableInputs(),i.toggleShowOn(),i.toggleTypes(),i.toggleDatepicker(),i.toggleEmailForm(),i.colors(),t(".pzen-datepicker").datepicker({dateFormat:"mm/dd/yy"}),t(".pzen-colors").wpColorPicker()},i.colors=function(){t(".pzen-accent-color").wpColorPicker({change:function(e,n){t("#pzen-customize-wrap .pzen-btn").css("background-color",e.target.value)}}),t(".pzen-bg-color").wpColorPicker({change:function(e,n){t("#pzen-customize-wrap .popup-zen-box").css("background-color",e.target.value)}}),t(".pzen-text-color").wpColorPicker({change:function(e,n){t(".pzen-content, .pzen-content .pzen-title, .pzen-content p, .popup-zen-box label").css("cssText","color:"+e.target.value+" !important"),t(".popup-zen-box input[type=text], .popup-zen-box input[type=email]").css("cssText","border-bottom-color: "+e.target.value+" !important;color:"+e.target.value+" !important")}}),t(".pzen-btn-text-color").wpColorPicker({change:function(e,n){t(".popup-zen-box .pzen-btn").css("color",e.target.value)}})},i.listeners=function(){t(".pzen-preview-btn, .pzen-close").on("click",function(e){e.preventDefault(),t("#pzen-customize-wrap .popup-zen-box").toggleClass("pzen-show"),t(e.target).closest(".popup-zen-box").removeClass("pzen-expanded")}),t(".pzen-expand-btn").on("click",i.expand),t(".pzen-collapse").on("click",i.collapse),t(n).on("tinymce-editor-init",function(n,t){i.updatePreviewContent(),e.tinymce.activeEditor.on("keyup",function(e){i.updatePreviewContent()})}),t("#wp-content-wrap").hasClass("html-active")&&i.updatePreviewContent(),t("body").on("change",".pzen-switch input",i.toggleSwitch).on("change","input[name=expiration]",i.toggleDatepicker).on("change","input[name=show_on]",i.toggleShowOn).on("change","input[name=pzen_type]",i.toggleTypes).on("change","select[name=email_provider]",i.toggleEmailForm).on("keyup","#content",i.updatePreviewContent).on("focus","input#scroll_delay",function(){t("input[name=display_when][value=delay]").prop("checked","checked")}).on("click","#pzen-upload-btn",i.mediaUpload).on("keyup","#show_on_pages",i.suggestPages)},i.suggestPages=function(e){if("Backspace"!=e.key){var n=e.currentTarget.value;n&&n.length<=1||t("input#show_on_pages").autocomplete({source:i.fetchPosts,minLength:3,delay:500,select:function(e,n){var t=this.value.split(/,\s*/);return t.pop(),t.push(n.item.value),t.push(""),this.value=t.join(", "),!1}})}},i.fetchPosts=function(n,o){var i=n.term;if(i.indexOf(", ")>0){var a=i.lastIndexOf(", ");i=i.substring(a+2)}t.ajax({url:e.ajaxurl,data:{action:"pzen_ajax_page_search",term:i},success:function(e){o(e.data)}})},i.disableInputs=function(){t(".popup-zen-box input, .popup-zen-box .pzen-email-btn").prop("disabled",!0)},i.expand=function(e){e.preventDefault();var n=t(e.target).closest(".popup-zen-box");n.attr("id").split("-")[1];n.addClass("pzen-expanded")},i.collapse=function(e){e.preventDefault(),t(e.target).closest(".popup-zen-box").removeClass("pzen-expanded")},i.toggleShowOn=function(){var e=t("input[name=show_on]:checked").val(),n=t("#show-certain-pages"),o=t("#pzen-cats"),i=t("#pzen-tags"),a=t("#pzen-types"),p=t("#pzen-exclude");switch(e){case"all":o.hide(),i.hide(),n.hide(),a.hide(),p.hide();break;case"limited":o.show(),i.show(),n.show(),a.show(),p.show();break;default:o.hide(),i.hide(),n.hide(),a.hide(),p.hide()}},i.toggleTypes=function(){var e=t("input[name=pzen_type]:checked").val(),n=t("#position-settings"),o=t("#pzen-name-fields"),i=t("#popup-link-options");switch(e){case"pzen_header_bar":i.hide(),n.hide(),o.hide();break;case"pzen_footer_bar":permissionBtns.fadeIn(),i.hide(),n.hide(),o.hide();break;case"pzen_popup_link":o.fadeIn(),i.fadeIn(),n.hide();break;case"pzen_box":n.fadeIn(),i.hide(),o.show();break;default:i.hide(),n.fadeIn(),o.hide()}},i.toggleEmailForm=function(){var e=t("#none-selected"),n=t("#custom-email-options"),o=t("select[name=email_provider]").val(),i=t("input[name=item_type]:checked").val(),a=t("#mailchimp-fields"),p=t("#ac-fields"),c=t("#convertkit-fields"),l=t("#mailpoet-fields"),s=t("#drip-fields");"optin"===i&&t("#pzen-email-options").fadeIn(),"default"===o?(e.fadeIn(),n.hide(),c.hide(),a.hide(),l.hide(),p.hide(),s.hide()):"custom"===o?(n.fadeIn(),e.hide(),c.hide(),a.hide(),l.hide(),p.hide(),s.hide()):"mc"===o?(a.fadeIn(),c.hide(),n.hide(),e.hide(),l.hide(),p.hide(),s.hide()):"ck"===o?(c.fadeIn(),a.hide(),n.hide(),e.hide(),l.hide(),p.hide(),s.hide()):"mailpoet"===o?(l.fadeIn(),a.hide(),n.hide(),e.hide(),c.hide(),p.hide(),s.hide()):"ac"===o?(c.hide(),a.hide(),n.hide(),e.hide(),l.hide(),p.fadeIn(),s.hide()):"drip"===o&&(s.fadeIn(),c.hide(),a.hide(),n.hide(),e.hide(),l.hide(),p.hide())},i.toggleChat=function(){t("input[name=show_chat]").is(":checked")?t("#pzen-chat").removeClass("pzen-hide"):t("#pzen-chat").addClass("pzen-hide")},i.toggleSwitch=function(){i.toggleActiveAjax(t(this).data("id"))},i.toggleActiveAjax=function(n){var o={action:"pzen_toggle_active",id:n};t.ajax({method:"GET",url:e.ajaxurl,data:o}).done(function(e){}).fail(function(e){console.log(e)})},i.toggleDatepicker=function(){t("input[name=expiration]").is(":checked")?t("#pzen-until-datepicker").show():t("#pzen-until-datepicker").hide()},i.updatePreviewContent=function(){var o;o=t("#wp-content-wrap").hasClass("tmce-active")?e.tinymce.get("content").getContent():t("#content").val();var i=n.getElementById("pzen-first-row");i&&(i.innerHTML=o)},i.mediaUpload=function(e){e.preventDefault();var n;n?n.open():((n=wp.media.frames.file_frame=wp.media({title:"Choose Image",button:{text:"Choose Image"},multiple:!1})).on("select",function(){var e=n.state().get("selection").first().toJSON();t("#pzen-image-url").val(e.url),t(".pzen-image").attr("src",e.url)}),n.open())},i.openTab=function(e,t){console.log("open tab "+t,e),e.preventDefault();var o,i,a;for(i=n.getElementsByClassName("pzen-tab-content"),o=0;o<i.length;o++)i[o].style.display="none";for(a=n.getElementsByClassName("pzen-tab-link"),o=0;o<a.length;o++)a[o].className=a[o].className.replace(" active","");n.getElementById(t).style.display="block",e.currentTarget.className+=" active"},i.init(),e.pzenAdmin=i}(window,document,jQuery);