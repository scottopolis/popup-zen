!function(e,n,i,o){function t(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}var p={};p.init=function(){p.newVisitor=!1,p.checkForPreview()},Date.now||(Date.now=function(){return(new Date).getTime()}),p.checkForPreview=function(){if(t("pzen_preview")){var n=t("pzen_preview");return p.showItem(n),void p.noteListeners(n)}p.checkCookie(),e.popupZenVars.active&&p.doActive(e.popupZenVars.active)},p.checkCookie=function(){""===p.getCookie("pzen_visit")?(p.setCookie("pzen_visit",Date.now(),parseInt(e.popupZenVars.expires)),p.setCookie("pzen_new","true",1),p.newVisitor=!0):""!=p.getCookie("pzen_new")&&(p.newVisitor=!0)},p.doActive=function(e){for(var n=0;n<e.length;n++)p.doChecks(e[n])},p.doChecks=function(o,t){if(n.getElementById("pzen-"+o)){var r=e.popupZenVars[o];if(r.visitor&&("new"!==r.visitor||1==p.newVisitor)&&!("returning"===r.visitor&&0!=p.newVisitor||"interacts"===r.showSettings&&""!=p.getCookie("pzen_"+o+"_int")||""===e.popupZenVars.isMobile&&"mobile_only"===r.devices||"1"===e.popupZenVars.isMobile&&"desktop_only"===r.devices)){var a=p.getCookie("pzen_"+o+"_shown");if("hide_for"!==r.showSettings||"true"!==a||t){if("exit"===r.display_when){if("true"===p.getCookie("pzen-"+o+"_hide"))return;i("body").on("mouseleave",p.mouseExit)}if("scroll"!=r.display_when){if("exit"===r.display_when&&!t||"link"===r.display_when&&!t)return;var s="delay"===r.display_when?parseInt(r.delay):0;if("pzen-popup"===r.type&&"always"===r.showSettings)p.setCookie("pzen-"+o+"_hide","",-1);else if("pzen-popup"===r.type&&"interacts"===r.showSettings&&"true"===p.getCookie("pzen-"+o+"_hide"))return;setTimeout(function(){p.showItem(o),p.trackingAndListeners(o)},1e3*s)}else p.detectScroll(o)}}}},p.noteListeners=function(e){i("body").on("click",".pzen-close",p.hideItem).on("click",".pzen-floating-btn",p.btnClick).on("click","#pzen-"+e+" .pzen-email-btn",p.emailSubmitClick).on("click",".pzen-backdrop",p.bdClick),i("#pzen-"+e+" .pzen-email-input").on("keypress",p.submitEmailOnEnter),i("#pzen-"+e+" a").on("click",p.interactionLink)},p.detectScroll=function(o){i(e).scroll(p.debounce(function(){i(e).scrollTop()/(i(n).height()-i(e).height())>(e.popupZenVars[o].scrollPercent?parseInt(e.popupZenVars[o].scrollPercent)/100:.5)&&!p.show["pzen-"+o]&&(p.showItem(o),p.show["pzen-"+o]=!0,p.trackingAndListeners(o))},150))},p.showItem=function(o){var t=e.popupZenVars[o],r=n.getElementById("pzen-"+o);"pzen-popup"===t.type&&i(r).hasClass("pzen-show")?p.transitionOut(i("#pzen-bd-"+o)):"pzen-popup"===t.type&&p.transitionIn(i("#pzen-bd-"+o)),"true"===p.getCookie("pzen-"+o+"_hide")?(p.transitionOut(r),"always"===t.showSettings&&("1"!==t.hideBtn&&"pzen_header_bar"!=t.type&&"pzen_footer_bar"!=t.type||p.setCookie("pzen-"+o+"_hide","",-1)),("1"!=t.hideBtn&&"pzen_header_bar"!=t.type||"pzen_header_bar"==t.type&&"always"===t.showSettings)&&p.transitionIn(i(".pzen-btn-"+o))):(p.transitionIn(r),"1"!=t.hideBtn&&"pzen_header_bar"!=t.type&&p.transitionOut(i(".pzen-btn-"+o)),p.showEmailSubmit(o)),"1"===t.hideBtn&&p.hide(i(".pzen-btn-"+o)),"pzen_header_bar"===t.type&&"true"!=p.getCookie("pzen-"+o+"_hide")&&p.toggleBnrMargin(o)},p.setCookie=function(e,i,o,t){var p=new Date;p.setTime(p.getTime()+24*o*60*60*1e3);var r="expires="+p.toUTCString();return t||(t="/"),n.cookie=e+"="+i+";"+r+";path="+t,i},p.getCookie=function(e){for(var i=e+"=",o=decodeURIComponent(n.cookie).split(";"),t=0;t<o.length;t++){for(var p=o[t];" "==p.charAt(0);)p=p.substring(1);if(0==p.indexOf(i))return p.substring(i.length,p.length)}return""},p.debounce=function(e,n){var i=null;return function(){var o=this,t=arguments;clearTimeout(i),i=setTimeout(function(){e.apply(o,t)},n)}},p.toggleBnrMargin=function(e,n){if(i("body").css("padding-top",""),!n){var o=i("#pzen-"+e).outerHeight();i("body").css("padding-top",o)}},p.hideItem=function(e){e.stopImmediatePropagation();var n=i(e.target).closest(".popup-zen-box"),o=n.attr("id").split("-")[1];return p.toggleHide(o),n.hasClass("pzen_header_bar")&&p.toggleBnrMargin(o,!0),!1},p.btnClick=function(e){e.stopImmediatePropagation();var n=i(this).data("id");p.toggleHide(n)},p.toggleHide=function(e){var n=p.getCookie("pzen-"+e+"_hide");console.log("hide "+e,n),"true"===n?p.setCookie("pzen-"+e+"_hide","true",-1):p.setCookie("pzen-"+e+"_hide","true",1),p.showItem(e)},p.transitionIn=function(e){i(e).css("display","block"),setTimeout(function(){i(e).addClass("pzen-transition-in").removeClass("pzen-hide")},1),setTimeout(function(){i(e).removeClass("pzen-transition-in").addClass("pzen-show")},300)},p.transitionOut=function(e){i(e).addClass("pzen-transition-out").removeClass("pzen-show"),setTimeout(function(){i(e).removeClass("pzen-transition-out").addClass("pzen-hide"),i(e).css("display","")},200)},p.show=function(e){e.style.display="block",i(e).removeClass("pzen-hide").addClass("pzen-show")},p.hide=function(e){i(e).removeClass("pzen-show").addClass("pzen-hide"),i(e).css("display","")},p.submitEmailOnEnter=function(e){if(e.target.value&&""!=e.target.value&&13==e.keyCode){var n=i(e.target).closest(".popup-zen-box").attr("id").split("-")[1];e.preventDefault(),p.emailSubmitted(n)}},p.showEmailSubmit=function(o){var t=i("#pzen-"+o+" .pzen-form"),p=e.popupZenVars[o];t.hasClass("pzen-show")||(n.querySelector("#pzen-"+o+" .pzen-email-input").setAttribute("placeholder",p.placeholder),i("#pzen-"+o).addClass("has-optin"),t.removeClass("pzen-hide").addClass("pzen-show"))},p.emailSubmitClick=function(e){e.stopImmediatePropagation(),e.preventDefault();var n=i(e.target).closest(".popup-zen-box").attr("id").split("-")[1];p.emailSubmitted(n)},p.emailSubmitted=function(n){var o=i("#pzen-"+n+" .pzen-email-input").val();if(o){i("#pzen-"+n+" .pzen-name").val(),i("#pzen-"+n+" .pzen-title").text();-1!==o.indexOf("@")&&-1!==o.indexOf(".")?""==i("#pzen-"+n+" input[name=pzen_hp]").val()&&("ck"!==e.popupZenVars[n].emailProvider?"mc"!==e.popupZenVars[n].emailProvider?"ac"!==e.popupZenVars[n].emailProvider?"mailpoet"!==e.popupZenVars[n].emailProvider?"drip"!==e.popupZenVars[n].emailProvider?"default"!==e.popupZenVars[n].emailProvider||p.sendEmail(o,n):p.dripSubscribe(o,n):p.mpSubscribe(o,n):p.acSubscribe(o,n):p.mcSubscribe(o,n):p.ckSubscribe(o,n)):alert(e.popupZenVars.emailErr+" err2"+o)}else alert(e.popupZenVars.emailErr+" err1")},p.sendEmail=function(n,o){p.showSpinner(o),i.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,id:o,action:"pzen_send_email",nonce:e.popupZenVars.pzenNonce}}).done(function(e){i("#pzen-"+o+" .pzen-form").hide(),p.showConfirmation(o),p.conversion(o)}).fail(function(e){console.log(e),p.hideSpinner()})},p.ckSubscribe=function(n,o){var t=e.popupZenVars[o],r="https://api.convertkit.com/v3/forms/"+i("#pzen-"+o+" .ck-form-id").val()+"/subscribe",a=i("#pzen-"+o+" .pzen-name").val();p.showSpinner(o),i.ajax({method:"POST",url:r,data:{email:n,api_key:t.ckApi,first_name:a}}).done(function(e){p.showConfirmation(o),i("#pzen-"+o+" .pzen-form").hide(),p.conversion(o)}).fail(function(e){p.hideSpinner(),i("#pzen-"+o+" .pzen-form").prepend('<span id="pzen-err">There seems to be a problem, can you try again?</span>'),setTimeout(function(){i("#pzen-err").remove()},3e3),console.log(e)})},p.mcSubscribe=function(n,o){var t=i("#pzen-"+o+" .mc-list-id").val(),r=i("#pzen-"+o+" .pzen-name").val(),a=i("#pzen-"+o+" .mc-interests").val();a&&(a=JSON.parse(a)),t?(p.showSpinner(o),i.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,list_id:t,action:"pzen_mc_subscribe",interests:a,nonce:e.popupZenVars.pzenNonce,name:r}}).done(function(e){p.showConfirmation(o),i("#pzen-"+o+" .pzen-form").hide(),p.conversion(o)}).fail(function(e){console.log(e),p.hideSpinner()})):alert("MailChimp list ID is missing.")},p.acSubscribe=function(n,o){var t=i("#pzen-"+o+" .ac-list-id").val(),r=i("#pzen-"+o+" .pzen-name").val();t?(p.showSpinner(o),i.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,list_id:t,action:"pzen_ac_subscribe",nonce:e.popupZenVars.pzenNonce,name:r}}).done(function(e){1==e.success?(p.showConfirmation(o),i("#pzen-"+o+" .pzen-form").hide(),p.conversion(o)):(console.warn(e),i("#pzen-"+o+" .pzen-content").html("<p>"+e.data+"</p>"),p.hideSpinner())}).fail(function(e){console.warn(e),p.hideSpinner()})):alert("List ID is missing.")},p.dripSubscribe=function(n,o){if(e._dcq){var t=i("#pzen-"+o+" .drip-tags").val(),r=i("#pzen-"+o+" .pzen-name").val(),a=t.split(",");p.showSpinner(o),p.dripid=o;_dcq.push(["identify",{email:n,first_name:r,tags:a,success:p.dripResponse,failure:p.dripResponse}])}else alert("Drip code not installed properly.")},p.dripResponse=function(e){p.hideSpinner(),1==e.success?(p.showConfirmation(p.dripid),i("#pzen-"+p.dripid+" .pzen-form").hide(),p.conversion(p.dripid)):(console.warn(e),i("#pzen-"+p.dripid+" .pzen-content").html("<p>"+e.error+"</p>"))},p.mpSubscribe=function(n,o){var t=i("#pzen-"+o+" .mailpoet-list-id").val();if(t){var r=i("#pzen-"+o+" .pzen-name").val();p.showSpinner(o),i.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,list_id:t,action:"pzen_mailpoet_subscribe",nonce:e.popupZenVars.pzenNonce,name:r}}).done(function(e){p.showConfirmation(o),i("#pzen-"+o+" .pzen-form").hide(),p.conversion(o)}).fail(function(e){console.log(e),p.hideSpinner()})}else alert("List ID is missing.")},p.interactionLink=function(e){if("https://getpopupzen.com/"!==e.target.href){var n=i(e.target).closest(".popup-zen-box").attr("id").split("-")[1];p.conversion(n)}},p.conversion=function(n){var o={action:"pzen_track_event",nonce:e.popupZenVars.pzenNonce,id:n};i.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:o}).done(function(o){var t=e.popupZenVars[n].redirect;t&&(i("#pzen-"+n+" .pzen-content").append(' Redirecting... <img src="'+e.popupZenVars.pluginUrl+'assets/img/loading.gif" class="pzen-loading" />'),setTimeout(function(){e.location.href=t},1e3))}).fail(function(e){console.log(e)}),p.setCookie("pzen_"+n+"_int","true",1)},p.showConfirmation=function(n){p.hideSpinner();var o=e.popupZenVars[n],t=""!=o.confirmMsg?o.confirmMsg:"Thanks!";"pzen_header_bar"===o.type?(i("#pzen-"+n+" .popup-zen-box-rows").addClass("pzen-full-width").html(t),p.toggleBnrMargin(n)):i("#pzen-"+n+" .pzen-content").html(t)},p.trackingAndListeners=function(n){p.noteListeners(n);var i=e.popupZenVars[n],o=i.hideForDays?parseInt(i.hideForDays):1;p.setCookie("pzen_"+n+"_shown","true",o),e.popupZenVars.ga_tracking},p.showSpinner=function(n){i("#pzen-"+n+" .pzen-form").html('<img src="'+e.popupZenVars.pluginUrl+'assets/img/loading.gif" class="pzen-loading" />'),i("#pzen-"+n+" .pzen-name-row").hide()},p.hideSpinner=function(){i("img.pzen-loading").remove()},p.bdClick=function(e){e.stopImmediatePropagation();var n=i(e.currentTarget).data("id");p.toggleHide(n)},p.mouseExit=function(e){var n=i(".popup-zen-box.pzen-show-on-exit")[0];if(n&&!i(n).hasClass("pzen-show")){var o=n.id.split("-")[1];p.doChecks(o,!0)}},i(e).on("load",function(){p.init()}),e.popupZen=p}(window,document,jQuery);