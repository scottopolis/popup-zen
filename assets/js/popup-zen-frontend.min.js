!function(e,n,i,o){function t(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}var s={};s.init=function(){s.newVisitor=!1,s.checkForPreview()},Date.now||(Date.now=function(){return(new Date).getTime()}),s.checkForPreview=function(){if(t("pzen_preview")){var n=t("pzen_preview");return s.setCookie("pzen-"+n+"_hide","",-1),s.showItem(n),void s.noteListeners(n)}s.checkCookie(),e.popupZenVars.active&&s.doActive(e.popupZenVars.active)},s.checkCookie=function(){""===s.getCookie("pzen_visit")?(s.setCookie("pzen_visit",Date.now(),parseInt(e.popupZenVars.expires)),s.setCookie("pzen_new","true",1),s.newVisitor=!0):""!=s.getCookie("pzen_new")&&(s.newVisitor=!0)},s.doActive=function(e){for(var n=0;n<e.length;n++)s.doChecks(e[n])},s.doChecks=function(o,t){if(n.getElementById("pzen-"+o)){var r=e.popupZenVars[o];if(r.visitor&&("new"!==r.visitor||1==s.newVisitor)&&!("returning"===r.visitor&&0!=s.newVisitor||"interacts"===r.showSettings&&""!=s.getCookie("pzen_"+o+"_int")||""===e.popupZenVars.isMobile&&"mobile_only"===r.devices||"1"===e.popupZenVars.isMobile&&"desktop_only"===r.devices)){var a=s.getCookie("pzen_"+o+"_shown");if("hide_for"!==r.showSettings||"true"!==a||t){if("exit"===r.display_when){if("true"===s.getCookie("pzen-"+o+"_hide"))return;i("body").on("mouseleave",s.mouseExit)}if("scroll"!=r.display_when){if("exit"===r.display_when&&!t||"link"===r.display_when&&!t)return;var p="delay"===r.display_when?parseInt(r.delay):0;if("pzen-popup"===r.type&&"always"===r.showSettings)s.setCookie("pzen-"+o+"_hide","",-1);else if("pzen-popup"===r.type&&"interacts"===r.showSettings&&"true"===s.getCookie("pzen-"+o+"_hide"))return;setTimeout(function(){s.showItem(o),s.trackingAndListeners(o)},1e3*p)}else s.detectScroll(o)}}}},s.noteListeners=function(e){i("body").on("click",".pzen-close",s.closeClick).on("click","#pzen-"+e+" .pzen-email-btn",s.emailSubmitClick).on("focus",".pzen-input input",function(e){i(e.currentTarget).addClass("input-filled")}).on("click",".pzen-backdrop",s.bdClick),i("#pzen-"+e+" .pzen-email-input").on("keypress",s.submitEmailOnEnter),i("#pzen-"+e+" a").on("click",s.interactionLink),i(".pzen-expand-btn").on("click",s.expand),i(".pzen-collapse").on("click",s.collapse)},s.expand=function(e){e.preventDefault();var n=i(e.target).closest(".popup-zen-box"),o=n.attr("id").split("-")[1];n.addClass("pzen-expanded"),i("input.pzen-name")?i("input.pzen-name").focus().addClass("input-filled"):i("input.pzen-email-input").focus().addClass("input-filled"),n.hasClass("pzen-popup")&&s.transitionIn(i("#pzen-bd-"+o))},s.collapse=function(e){e.preventDefault();var n=i(e.target).closest(".popup-zen-box");n.removeClass("pzen-expanded");var o=n.attr("id").split("-")[1];i("#pzen-"+o+" input").val("").removeClass("input-filled"),n.hasClass("pzen-popup")&&s.transitionOut(i("#pzen-bd-"+o))},s.detectScroll=function(o){i(e).scroll(s.debounce(function(){i(e).scrollTop()/(i(n).height()-i(e).height())>(e.popupZenVars[o].scrollPercent?parseInt(e.popupZenVars[o].scrollPercent)/100:.5)&&!s.show["pzen-"+o]&&(s.showItem(o),s.show["pzen-"+o]=!0,s.trackingAndListeners(o))},100))},s.showItem=function(i){e.popupZenVars[i];var o=n.getElementById("pzen-"+i);s.transitionIn(o)},s.setCookie=function(e,i,o,t){var s=new Date;s.setTime(s.getTime()+24*o*60*60*1e3);var r="expires="+s.toUTCString();return t||(t="/"),n.cookie=e+"="+i+";"+r+";path="+t,i},s.getCookie=function(e){for(var i=e+"=",o=decodeURIComponent(n.cookie).split(";"),t=0;t<o.length;t++){for(var s=o[t];" "==s.charAt(0);)s=s.substring(1);if(0==s.indexOf(i))return s.substring(i.length,s.length)}return""},s.debounce=function(e,n){var i=null;return function(){var o=this,t=arguments;clearTimeout(i),i=setTimeout(function(){e.apply(o,t)},n)}},s.toggleBnrMargin=function(e,n){if(i("body").css("padding-top",""),!n){var o=i("#pzen-"+e).outerHeight();i("body").css("padding-top",o)}},s.closeClick=function(e){e.stopImmediatePropagation();var n=i(e.target).closest(".popup-zen-box").attr("id").split("-")[1];s.hideItem(n)},s.hideItem=function(e){return s.transitionOut(i("#pzen-"+e)),i("#pzen-"+e).hasClass("pzen-popup")&&s.transitionOut(i("#pzen-bd-"+e)),s.setCookie("pzen-"+e+"_hide","true",1),s.setCookie("pzen_"+e+"_int","true",1),!1},s.transitionIn=function(e){i(e).css("display","block"),setTimeout(function(){i(e).addClass("pzen-transition-in").removeClass("pzen-hide")},1),setTimeout(function(){i(e).removeClass("pzen-transition-in").addClass("pzen-show")},300)},s.transitionOut=function(e){i(e).addClass("pzen-transition-out").removeClass("pzen-show"),setTimeout(function(){i(e).removeClass("pzen-transition-out").addClass("pzen-hide"),i(e).css("display","")},200)},s.show=function(e){e.style.display="block",i(e).removeClass("pzen-hide").addClass("pzen-show")},s.hide=function(e){i(e).removeClass("pzen-show").addClass("pzen-hide"),i(e).css("display","")},s.submitEmailOnEnter=function(e){if(e.target.value&&""!=e.target.value&&13==e.keyCode){var n=i(e.target).closest(".popup-zen-box").attr("id").split("-")[1];e.preventDefault(),s.emailSubmitted(n)}},s.emailSubmitClick=function(e){e.stopImmediatePropagation(),e.preventDefault();var n=i(e.target).closest(".popup-zen-box").attr("id").split("-")[1];s.emailSubmitted(n)},s.emailSubmitted=function(n){var o=i("#pzen-"+n+" .pzen-email-input input[type=email]").val();if(o){i("#pzen-"+n+" .pzen-name").val(),i("#pzen-"+n+" .pzen-title").text();-1!==o.indexOf("@")&&-1!==o.indexOf(".")?""==i("#pzen-"+n+" input[name=pzen_hp]").val()&&(i("#pzen-"+n).addClass("pzen-loading"),"ck"!==e.popupZenVars[n].emailProvider?"mc"!==e.popupZenVars[n].emailProvider?"ac"!==e.popupZenVars[n].emailProvider?"mailpoet"!==e.popupZenVars[n].emailProvider?"drip"!==e.popupZenVars[n].emailProvider?"default"!==e.popupZenVars[n].emailProvider||s.sendEmail(o,n):s.dripSubscribe(o,n):s.mpSubscribe(o,n):s.acSubscribe(o,n):s.mcSubscribe(o,n):s.ckSubscribe(o,n)):alert(e.popupZenVars.emailErr+" err2")}else alert(e.popupZenVars.emailErr+" err1")},s.sendEmail=function(n,o){i.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,id:o,action:"pzen_send_email",nonce:e.popupZenVars.pzenNonce}}).done(function(e){s.showConfirmation(o),s.conversion(o)}).fail(function(e){console.log(e),s.resetForm(o)})},s.ckSubscribe=function(n,o){var t=e.popupZenVars[o],r="https://api.convertkit.com/v3/forms/"+i("#pzen-"+o+" .ck-form-id").val()+"/subscribe",a=i("#pzen-"+o+" .pzen-name").val();i.ajax({method:"POST",url:r,data:{email:n,api_key:t.ckApi,first_name:a}}).done(function(e){s.showConfirmation(o),s.conversion(o)}).fail(function(e){s.resetForm(o);var n="There seems to be a problem, can you try again?";e.responseJSON&&e.responseJSON.error&&(n=e.responseJSON.error,e.responseJSON.message&&(n+=" "+e.responseJSON.message)),s.doError(n,o),console.log(e)})},s.mcSubscribe=function(n,o){var t=i("#pzen-"+o+" .mc-list-id").val(),r=i("#pzen-"+o+" .pzen-name").val(),a=i("#pzen-"+o+" .mc-interests").val();if(a&&(a=JSON.parse(a)),!t)return alert("MailChimp list ID is missing."),void s.resetForm(o);i.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,list_id:t,action:"pzen_mc_subscribe",interests:a,nonce:e.popupZenVars.pzenNonce,name:r}}).done(function(e){s.showConfirmation(o),s.conversion(o)}).fail(function(e){console.log(e),s.resetForm(o),s.doError("There was a problem.",o)})},s.acSubscribe=function(n,o){var t=i("#pzen-"+o+" .ac-list-id").val(),r=i("#pzen-"+o+" .pzen-name").val();if(!t)return alert("List ID is missing."),void s.resetForm(o);i.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,list_id:t,action:"pzen_ac_subscribe",nonce:e.popupZenVars.pzenNonce,name:r}}).done(function(e){1==e.success?(s.showConfirmation(o),s.conversion(o)):(console.warn(e),i("#pzen-"+o+" .pzen-content").html("<p>"+e.data+"</p>"),s.resetForm(o))}).fail(function(e){console.warn(e),s.resetForm(o),s.doError("There was a problem.",o)})},s.dripSubscribe=function(n,o){if(!e._dcq)return alert("Drip code not installed properly."),void s.resetForm(o);var t=i("#pzen-"+o+" .drip-tags").val(),r=i("#pzen-"+o+" .pzen-name").val(),a=t.split(",");s.dripid=o;_dcq.push(["identify",{email:n,first_name:r,tags:a,success:s.dripResponse,failure:s.dripResponse}])},s.dripResponse=function(e){s.resetForm(id),1==e.success?(s.showConfirmation(s.dripid),s.conversion(s.dripid)):(console.warn(e),s.doError(e.error,id))},s.mpSubscribe=function(n,o){var t=i("#pzen-"+o+" .mailpoet-list-id").val();if(t){var r=i("#pzen-"+o+" .pzen-name").val();i.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,list_id:t,action:"pzen_mailpoet_subscribe",nonce:e.popupZenVars.pzenNonce,name:r}}).done(function(e){s.showConfirmation(o),s.conversion(o)}).fail(function(e){console.log(e),s.resetForm(o),s.doError(response.error,o)})}else alert("List ID is missing.")},s.interactionLink=function(e){if("https://getpopupzen.com/"!==e.target.href){var n=i(e.target).closest(".popup-zen-box").attr("id").split("-")[1];s.conversion(n)}},s.conversion=function(n){var o={action:"pzen_track_event",nonce:e.popupZenVars.pzenNonce,id:n};i.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:o}).done(function(o){var t=e.popupZenVars[n].redirect;t&&(i("#pzen-"+n+" .pzen-content").append(' Redirecting... <img src="'+e.popupZenVars.pluginUrl+'assets/img/loading.gif" class="pzen-loading" />'),setTimeout(function(){e.location.href=t},1e3))}).fail(function(e){console.log(e)}),s.setCookie("pzen_"+n+"_int","true",1)},s.showConfirmation=function(n){i(".pzen-email-btn span").css("opacity",0),s.resetForm(n);var o=e.popupZenVars[n],t=""!=o.confirmMsg?o.confirmMsg:"Thanks!";i("#pzen-"+n+" .pzen-form").after('<div class="pzen-confirmation-message"><svg class="pzen-checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="pzen-checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="pzen-checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg>'+t+"</div>"),setTimeout(function(){i("#pzen-"+n).removeClass("pzen-loading").addClass("pzen-success")},100),setTimeout(function(){i("#pzen-"+n+" .pzen-close").click()},4e3)},s.trackingAndListeners=function(n){s.noteListeners(n);var i=e.popupZenVars[n],o=i.hideForDays?parseInt(i.hideForDays):1;s.setCookie("pzen_"+n+"_shown","true",o),e.popupZenVars.ga_tracking},s.resetForm=function(e){i("#pzen-"+e).removeClass("pzen-loading")},s.doError=function(e,n){i("#pzen-"+n+" #pzen-err").text(e).addClass("show-error"),setTimeout(function(){i("#pzen-"+n+" #pzen-err").removeClass("show-error").text("")},5e3)},s.bdClick=function(e){e.stopImmediatePropagation();var n=i(e.currentTarget).data("id");s.hideItem(n),s.transitionOut(i("#pzen-bd-"+n))},s.mouseExit=function(e){var n=i(".popup-zen-box.pzen-show-on-exit")[0];if(n&&!i(n).hasClass("pzen-show")){var o=n.id.split("-")[1];s.doChecks(o,!0)}},i(e).on("load",function(){s.init()}),e.popupZen=s}(window,document,jQuery);