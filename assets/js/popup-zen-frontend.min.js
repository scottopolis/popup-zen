!function(e,n,o,i){function t(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}var s={};s.init=function(){s.newVisitor=!1,s.checkForPreview()},Date.now||(Date.now=function(){return(new Date).getTime()}),s.checkForPreview=function(){if(t("pzen_preview")){var n=t("pzen_preview");return s.setCookie("pzen-"+n+"_hide","",-1),s.showItem(n),void s.noteListeners(n)}s.checkCookie(),e.popupZenVars.active&&s.doActive(e.popupZenVars.active)},s.checkCookie=function(){""===s.getCookie("pzen_visit")?(s.setCookie("pzen_visit",Date.now(),parseInt(e.popupZenVars.expires)),s.setCookie("pzen_new","true",1),s.newVisitor=!0):""!=s.getCookie("pzen_new")&&(s.newVisitor=!0)},s.doActive=function(e){for(var n=0;n<e.length;n++)s.doChecks(e[n])},s.doChecks=function(i,t){if(n.getElementById("pzen-"+i)){var r=e.popupZenVars[i];if(r.visitor&&("new"!==r.visitor||1==s.newVisitor)&&!("returning"===r.visitor&&0!=s.newVisitor||"interacts"===r.showSettings&&""!=s.getCookie("pzen_"+i+"_int")||""===e.popupZenVars.isMobile&&"mobile_only"===r.devices||"1"===e.popupZenVars.isMobile&&"desktop_only"===r.devices)){var a=s.getCookie("pzen_"+i+"_shown");if("hide_for"!==r.showSettings||"true"!==a||t){if("exit"===r.display_when){if("true"===s.getCookie("pzen-"+i+"_hide"))return;o("body").on("mouseleave",s.mouseExit)}if("scroll"!=r.display_when){if("exit"===r.display_when&&!t||"link"===r.display_when&&!t)return;var p="delay"===r.display_when?parseInt(r.delay):0;if("pzen-popup"===r.type&&"always"===r.showSettings)s.setCookie("pzen-"+i+"_hide","",-1);else if("pzen-popup"===r.type&&"interacts"===r.showSettings&&"true"===s.getCookie("pzen-"+i+"_hide"))return;setTimeout(function(){s.showItem(i),s.trackingAndListeners(i)},1e3*p)}else s.detectScroll(i)}}}},s.noteListeners=function(e){o("body").on("click",".pzen-close",s.closeClick).on("click","#pzen-"+e+" .pzen-email-btn",s.emailSubmitClick).on("focus",".pzen-input input",function(e){o(e.currentTarget).addClass("input-filled")}).on("click",".pzen-backdrop",s.bdClick),o("#pzen-"+e+" .pzen-email-input").on("keypress",s.submitEmailOnEnter),o("#pzen-"+e+" a").on("click",s.interactionLink),o(".pzen-expand-btn").on("click",s.expand),o(".pzen-collapse").on("click",s.collapse)},s.expand=function(e){e.preventDefault();var n=o(e.target).closest(".popup-zen-box"),i=n.attr("id").split("-")[1];n.addClass("pzen-expanded"),o("input.pzen-name")?o("input.pzen-name").focus().addClass("input-filled"):o("input.pzen-email-input").focus().addClass("input-filled"),n.hasClass("pzen-popup")&&s.transitionIn(o("#pzen-bd-"+i))},s.collapse=function(e){e.preventDefault();var n=o(e.target).closest(".popup-zen-box");n.removeClass("pzen-expanded");var i=n.attr("id").split("-")[1];o("#pzen-"+i+" input").val("").removeClass("input-filled"),n.hasClass("pzen-popup")&&s.transitionOut(o("#pzen-bd-"+i))},s.detectScroll=function(i){o(e).scroll(s.debounce(function(){console.log("scroll debounce"),o(e).scrollTop()/(o(n).height()-o(e).height())>(e.popupZenVars[i].scrollPercent?parseInt(e.popupZenVars[i].scrollPercent)/100:.5)&&!s.show["pzen-"+i]&&(s.showItem(i),s.show["pzen-"+i]=!0,s.trackingAndListeners(i))},100))},s.showItem=function(o){e.popupZenVars[o];var i=n.getElementById("pzen-"+o);s.transitionIn(i)},s.setCookie=function(e,o,i,t){var s=new Date;s.setTime(s.getTime()+24*i*60*60*1e3);var r="expires="+s.toUTCString();return t||(t="/"),n.cookie=e+"="+o+";"+r+";path="+t,o},s.getCookie=function(e){for(var o=e+"=",i=decodeURIComponent(n.cookie).split(";"),t=0;t<i.length;t++){for(var s=i[t];" "==s.charAt(0);)s=s.substring(1);if(0==s.indexOf(o))return s.substring(o.length,s.length)}return""},s.debounce=function(e,n){var o=null;return function(){var i=this,t=arguments;clearTimeout(o),o=setTimeout(function(){e.apply(i,t)},n)}},s.toggleBnrMargin=function(e,n){if(o("body").css("padding-top",""),!n){var i=o("#pzen-"+e).outerHeight();o("body").css("padding-top",i)}},s.closeClick=function(e){e.stopImmediatePropagation();var n=o(e.target).closest(".popup-zen-box").attr("id").split("-")[1];s.hideItem(n)},s.hideItem=function(e){return s.transitionOut(o("#pzen-"+e)),o("#pzen-"+e).hasClass("pzen-popup")&&s.transitionOut(o("#pzen-bd-"+e)),s.setCookie("pzen-"+e+"_hide","true",1),s.setCookie("pzen_"+e+"_int","true",1),!1},s.transitionIn=function(e){o(e).css("display","block"),setTimeout(function(){o(e).addClass("pzen-transition-in").removeClass("pzen-hide")},1),setTimeout(function(){o(e).removeClass("pzen-transition-in").addClass("pzen-show")},300)},s.transitionOut=function(e){o(e).addClass("pzen-transition-out").removeClass("pzen-show"),setTimeout(function(){o(e).removeClass("pzen-transition-out").addClass("pzen-hide"),o(e).css("display","")},200)},s.show=function(e){e.style.display="block",o(e).removeClass("pzen-hide").addClass("pzen-show")},s.hide=function(e){o(e).removeClass("pzen-show").addClass("pzen-hide"),o(e).css("display","")},s.submitEmailOnEnter=function(e){if(e.target.value&&""!=e.target.value&&13==e.keyCode){var n=o(e.target).closest(".popup-zen-box").attr("id").split("-")[1];e.preventDefault(),s.emailSubmitted(n)}},s.emailSubmitClick=function(e){e.stopImmediatePropagation(),e.preventDefault();var n=o(e.target).closest(".popup-zen-box").attr("id").split("-")[1];s.emailSubmitted(n)},s.emailSubmitted=function(n){var i=o("#pzen-"+n+" .pzen-email-input input[type=email]").val();if(i){o("#pzen-"+n+" .pzen-name").val(),o("#pzen-"+n+" .pzen-title").text();-1!==i.indexOf("@")&&-1!==i.indexOf(".")?""==o("#pzen-"+n+" input[name=pzen_hp]").val()&&(o("#pzen-"+n).addClass("pzen-loading"),"ck"!==e.popupZenVars[n].emailProvider?"mc"!==e.popupZenVars[n].emailProvider?"ac"!==e.popupZenVars[n].emailProvider?"mailpoet"!==e.popupZenVars[n].emailProvider?"drip"!==e.popupZenVars[n].emailProvider?"default"!==e.popupZenVars[n].emailProvider||s.sendEmail(i,n):s.dripSubscribe(i,n):s.mpSubscribe(i,n):s.acSubscribe(i,n):s.mcSubscribe(i,n):s.ckSubscribe(i,n)):alert(e.popupZenVars.emailErr+" err2")}else alert(e.popupZenVars.emailErr+" err1")},s.sendEmail=function(n,i){o.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,id:i,action:"pzen_send_email",nonce:e.popupZenVars.pzenNonce}}).done(function(e){s.showConfirmation(i),s.conversion(i)}).fail(function(e){console.log(e),s.resetForm(i)})},s.ckSubscribe=function(n,i){var t=e.popupZenVars[i],r="https://api.convertkit.com/v3/forms/"+o("#pzen-"+i+" .ck-form-id").val()+"/subscribe",a=o("#pzen-"+i+" .pzen-name").val();o.ajax({method:"POST",url:r,data:{email:n,api_key:t.ckApi,first_name:a}}).done(function(e){s.showConfirmation(i),s.conversion(i)}).fail(function(e){s.resetForm(i);var n="There seems to be a problem, can you try again?";e.responseJSON&&e.responseJSON.error&&(n=e.responseJSON.error,e.responseJSON.message&&(n+=" "+e.responseJSON.message)),s.doError(n,i),console.log(e)})},s.mcSubscribe=function(n,i){var t=o("#pzen-"+i+" .mc-list-id").val(),r=o("#pzen-"+i+" .pzen-name").val(),a=o("#pzen-"+i+" .mc-interests").val();if(a&&(a=JSON.parse(a)),!t)return alert("MailChimp list ID is missing."),void s.resetForm(i);o.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,list_id:t,action:"pzen_mc_subscribe",interests:a,nonce:e.popupZenVars.pzenNonce,name:r}}).done(function(e){s.showConfirmation(i),s.conversion(i)}).fail(function(e){console.log(e),s.resetForm(i),s.doError("There was a problem.",i)})},s.acSubscribe=function(n,i){var t=o("#pzen-"+i+" .ac-list-id").val(),r=o("#pzen-"+i+" .pzen-name").val();if(!t)return alert("List ID is missing."),void s.resetForm(i);o.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,list_id:t,action:"pzen_ac_subscribe",nonce:e.popupZenVars.pzenNonce,name:r}}).done(function(e){1==e.success?(s.showConfirmation(i),s.conversion(i)):(console.warn(e),o("#pzen-"+i+" .pzen-content").html("<p>"+e.data+"</p>"),s.resetForm(i))}).fail(function(e){console.warn(e),s.resetForm(i),s.doError("There was a problem.",i)})},s.dripSubscribe=function(n,i){if(!e._dcq)return alert("Drip code not installed properly."),void s.resetForm(i);var t=o("#pzen-"+i+" .drip-tags").val(),r=o("#pzen-"+i+" .pzen-name").val(),a=t.split(",");s.dripid=i;_dcq.push(["identify",{email:n,first_name:r,tags:a,success:s.dripResponse,failure:s.dripResponse}])},s.dripResponse=function(e){s.resetForm(id),1==e.success?(s.showConfirmation(s.dripid),s.conversion(s.dripid)):(console.warn(e),s.doError(e.error,id))},s.mpSubscribe=function(n,i){var t=o("#pzen-"+i+" .mailpoet-list-id").val();if(t){var r=o("#pzen-"+i+" .pzen-name").val();o.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:{email:n,list_id:t,action:"pzen_mailpoet_subscribe",nonce:e.popupZenVars.pzenNonce,name:r}}).done(function(e){s.showConfirmation(i),s.conversion(i)}).fail(function(e){console.log(e),s.resetForm(i),s.doError(response.error,i)})}else alert("List ID is missing.")},s.interactionLink=function(e){if("https://getpopupzen.com/"!==e.target.href){var n=o(e.target).closest(".popup-zen-box").attr("id").split("-")[1];s.conversion(n)}},s.conversion=function(n){var i={action:"pzen_track_event",nonce:e.popupZenVars.pzenNonce,id:n};o.ajax({method:"GET",url:e.popupZenVars.ajaxurl,data:i}).done(function(i){var t=e.popupZenVars[n].redirect;t&&(o("#pzen-"+n+" .pzen-content").append(' Redirecting... <img src="'+e.popupZenVars.pluginUrl+'assets/img/loading.gif" class="pzen-loading" />'),setTimeout(function(){e.location.href=t},1e3))}).fail(function(e){console.log(e)}),s.setCookie("pzen_"+n+"_int","true",1)},s.showConfirmation=function(n){o(".pzen-email-btn span").css("opacity",0),s.resetForm(n);var i=e.popupZenVars[n],t=""!=i.confirmMsg?i.confirmMsg:"Thanks!";o("#pzen-"+n+" .pzen-form").after('<div class="pzen-confirmation-message"><svg class="pzen-checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="pzen-checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="pzen-checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg>'+t+"</div>"),setTimeout(function(){o("#pzen-"+n).removeClass("pzen-loading").addClass("pzen-success")},100),setTimeout(function(){o("#pzen-"+n+" .pzen-close").click()},4e3)},s.trackingAndListeners=function(n){s.noteListeners(n);var o=e.popupZenVars[n],i=o.hideForDays?parseInt(o.hideForDays):1;s.setCookie("pzen_"+n+"_shown","true",i),e.popupZenVars.ga_tracking},s.resetForm=function(e){o("#pzen-"+e).removeClass("pzen-loading")},s.doError=function(e,n){o("#pzen-"+n+" #pzen-err").text(e).addClass("show-error"),setTimeout(function(){o("#pzen-"+n+" #pzen-err").removeClass("show-error").text("")},5e3)},s.bdClick=function(e){e.stopImmediatePropagation();var n=o(e.currentTarget).data("id");s.hideItem(n),s.transitionOut(o("#pzen-bd-"+n))},s.mouseExit=function(e){var n=o(".popup-zen-box.pzen-show-on-exit")[0];if(n&&!o(n).hasClass("pzen-show")){var i=n.id.split("-")[1];s.doChecks(i,!0)}},o(e).on("load",function(){s.init()}),e.popupZen=s}(window,document,jQuery);